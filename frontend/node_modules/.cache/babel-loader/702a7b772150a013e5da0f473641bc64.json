{"remainingRequest":"C:\\Users\\dekel\\Desktop\\Coding Acadeny\\MyProjects\\Day47-CLI-FrameworkAdvanced\\mistertoy\\frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\dekel\\Desktop\\Coding Acadeny\\MyProjects\\Day47-CLI-FrameworkAdvanced\\mistertoy\\frontend\\src\\services\\socket.service.js","dependencies":[{"path":"C:\\Users\\dekel\\Desktop\\Coding Acadeny\\MyProjects\\Day47-CLI-FrameworkAdvanced\\mistertoy\\frontend\\src\\services\\socket.service.js","mtime":1626099220776},{"path":"C:\\Users\\dekel\\Desktop\\Coding Acadeny\\MyProjects\\Day47-CLI-FrameworkAdvanced\\mistertoy\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\dekel\\Desktop\\Coding Acadeny\\MyProjects\\Day47-CLI-FrameworkAdvanced\\mistertoy\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJDOi9Vc2Vycy9kZWtlbC9EZXNrdG9wL0NvZGluZyBBY2FkZW55L015UHJvamVjdHMvRGF5NDctQ0xJLUZyYW1ld29ya0FkdmFuY2VkL21pc3RlcnRveS9mcm9udGVuZC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXkiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiQzovVXNlcnMvZGVrZWwvRGVza3RvcC9Db2RpbmcgQWNhZGVueS9NeVByb2plY3RzL0RheTQ3LUNMSS1GcmFtZXdvcmtBZHZhbmNlZC9taXN0ZXJ0b3kvZnJvbnRlbmQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgaW8gZnJvbSAnc29ja2V0LmlvLWNsaWVudCc7CmltcG9ydCB7IGh0dHBTZXJ2aWNlIH0gZnJvbSAnLi9odHRwLnNlcnZpY2UnOwpleHBvcnQgdmFyIFNPQ0tFVF9FTUlUX1VTRVJfV0FUQ0ggPSAndXNlci13YXRjaCc7CmV4cG9ydCB2YXIgU09DS0VUX0VWRU5UX1VTRVJfVVBEQVRFRCA9ICd1c2VyLXVwZGF0ZWQnOwpleHBvcnQgdmFyIFNPQ0tFVF9FVkVOVF9SRVZJRVdfQURERUQgPSAncmV2aWV3LWFkZGVkJzsKZXhwb3J0IHZhciBTT0NLRVRfRVZFTlRfUkVWSUVXX0FCT1VUX1lPVSA9ICdyZXZpZXctYWJvdXQteW91JzsKdmFyIGJhc2VVcmwgPSBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nID8gJycgOiAnLy9sb2NhbGhvc3Q6MzAzMCc7CmV4cG9ydCB2YXIgc29ja2V0U2VydmljZSA9IGNyZWF0ZVNvY2tldFNlcnZpY2UoKTsgLy8gZXhwb3J0IGNvbnN0IHNvY2tldFNlcnZpY2UgPSBjcmVhdGVEdW1teVNvY2tldFNlcnZpY2UoKQoKd2luZG93LnNvY2tldFNlcnZpY2UgPSBzb2NrZXRTZXJ2aWNlOyAvLyB2YXIgc29ja2V0SXNSZWFkeSA9IGZhbHNlOwoKc29ja2V0U2VydmljZS5zZXR1cCgpOwoKZnVuY3Rpb24gY3JlYXRlU29ja2V0U2VydmljZSgpIHsKICB2YXIgc29ja2V0ID0gbnVsbDsKICB2YXIgc29ja2V0U2VydmljZSA9IHsKICAgIHNldHVwOiBmdW5jdGlvbiBzZXR1cCgpIHsKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAvLyBZYXJvbkI6IE5lZWQgdG8gc2VuZCBhIGR1bW15IGFqYXggcmVxdWVzdCBhcyB0byBzZXR1cCB0aGUgc29ja2V0LXNlc3Npb24gY29ycmVjdGx5CiAgICAgICAgICAgICAgICAvLyBhd2FpdCBodHRwU2VydmljZS5nZXQoJ3NldHVwLXNlc3Npb24nKQogICAgICAgICAgICAgICAgLy8gc29ja2V0ID0gaW8oYmFzZVVybCwgeyByZWNvbm5lY3Rpb246IGZhbHNlfSkKICAgICAgICAgICAgICAgIHNvY2tldCA9IGlvKGJhc2VVcmwpOyAvLyBzb2NrZXRJc1JlYWR5ID0gdHJ1ZTsKCiAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIG9uOiBmdW5jdGlvbiBvbihldmVudE5hbWUsIGNiKSB7CiAgICAgIHNvY2tldC5vbihldmVudE5hbWUsIGNiKTsKICAgIH0sCiAgICBvZmY6IGZ1bmN0aW9uIG9mZihldmVudE5hbWUpIHsKICAgICAgdmFyIGNiID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBudWxsOwogICAgICBpZiAoIXNvY2tldCkgcmV0dXJuOwogICAgICBpZiAoIWNiKSBzb2NrZXQucmVtb3ZlQWxsTGlzdGVuZXJzKGV2ZW50TmFtZSk7ZWxzZSBzb2NrZXQub2ZmKGV2ZW50TmFtZSwgY2IpOwogICAgfSwKICAgIGVtaXQ6IGZ1bmN0aW9uIGVtaXQoZXZlbnROYW1lLCBkYXRhKSB7CiAgICAgIHNvY2tldC5lbWl0KGV2ZW50TmFtZSwgZGF0YSk7CiAgICB9LAogICAgdGVybWluYXRlOiBmdW5jdGlvbiB0ZXJtaW5hdGUoKSB7CiAgICAgIHNvY2tldCA9IG51bGw7CiAgICB9LAogICAgYnJvYWRjYXN0OiBmdW5jdGlvbiBicm9hZGNhc3QoZXZlbnROYW1lLCBkYXRhKSB7CiAgICAgIHNvY2tldC5icm9hZGNhc3QuZW1pdChldmVudE5hbWUsIGRhdGEpOwogICAgfQogIH07CiAgcmV0dXJuIHNvY2tldFNlcnZpY2U7Cn0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lCgoKZnVuY3Rpb24gY3JlYXRlRHVtbXlTb2NrZXRTZXJ2aWNlKCkgewogIHZhciBsaXN0ZW5lcnNNYXAgPSB7fTsKICB2YXIgc29ja2V0U2VydmljZSA9IHsKICAgIGxpc3RlbmVyc01hcDogbGlzdGVuZXJzTWFwLAogICAgc2V0dXA6IGZ1bmN0aW9uIHNldHVwKCkgewogICAgICBsaXN0ZW5lcnNNYXAgPSB7fTsKICAgIH0sCiAgICB0ZXJtaW5hdGU6IGZ1bmN0aW9uIHRlcm1pbmF0ZSgpIHsKICAgICAgdGhpcy5zZXR1cCgpOwogICAgfSwKICAgIG9uOiBmdW5jdGlvbiBvbihldmVudE5hbWUsIGNiKSB7CiAgICAgIGxpc3RlbmVyc01hcFtldmVudE5hbWVdID0gW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShsaXN0ZW5lcnNNYXBbZXZlbnROYW1lXSB8fCBbXSksIFtjYl0pOwogICAgfSwKICAgIG9mZjogZnVuY3Rpb24gb2ZmKGV2ZW50TmFtZSwgY2IpIHsKICAgICAgaWYgKCFsaXN0ZW5lcnNNYXBbZXZlbnROYW1lXSkgcmV0dXJuOwogICAgICBpZiAoIWNiKSBkZWxldGUgbGlzdGVuZXJzTWFwW2V2ZW50TmFtZV07ZWxzZSBsaXN0ZW5lcnNNYXBbZXZlbnROYW1lXSA9IGxpc3RlbmVyc01hcFtldmVudE5hbWVdLmZpbHRlcihmdW5jdGlvbiAobCkgewogICAgICAgIHJldHVybiBsICE9PSBjYjsKICAgICAgfSk7CiAgICB9LAogICAgZW1pdDogZnVuY3Rpb24gZW1pdChldmVudE5hbWUsIGRhdGEpIHsKICAgICAgaWYgKCFsaXN0ZW5lcnNNYXBbZXZlbnROYW1lXSkgcmV0dXJuOwogICAgICBsaXN0ZW5lcnNNYXBbZXZlbnROYW1lXS5mb3JFYWNoKGZ1bmN0aW9uIChsaXN0ZW5lcikgewogICAgICAgIGxpc3RlbmVyKGRhdGEpOwogICAgICB9KTsKICAgIH0sCiAgICBkZWJ1Z01zZzogZnVuY3Rpb24gZGVidWdNc2coKSB7CiAgICAgIHRoaXMuZW1pdCgnY2hhdCBhZGRNc2cnLCB7CiAgICAgICAgZnJvbTogJ1NvbWVvbmUnLAogICAgICAgIHR4dDogJ0FoYSBpdCB3b3JrZWQhJwogICAgICB9KTsKICAgIH0KICB9OwogIHJldHVybiBzb2NrZXRTZXJ2aWNlOwp9IC8vIEJhc2ljIFRlc3RzCi8vIGZ1bmN0aW9uIGNiKHgpIHtjb25zb2xlLmxvZyh4KX0KLy8gc29ja2V0U2VydmljZS5vbignYmFiYScsIGNiKQovLyBzb2NrZXRTZXJ2aWNlLmVtaXQoJ2JhYmEnLCAnREFUQScpCi8vIHNvY2tldFNlcnZpY2Uub2ZmKCdiYWJhJywgY2Ip"},{"version":3,"sources":["C:/Users/dekel/Desktop/Coding Acadeny/MyProjects/Day47-CLI-FrameworkAdvanced/mistertoy/frontend/src/services/socket.service.js"],"names":["io","httpService","SOCKET_EMIT_USER_WATCH","SOCKET_EVENT_USER_UPDATED","SOCKET_EVENT_REVIEW_ADDED","SOCKET_EVENT_REVIEW_ABOUT_YOU","baseUrl","process","env","NODE_ENV","socketService","createSocketService","window","setup","socket","on","eventName","cb","off","removeAllListeners","emit","data","terminate","broadcast","createDummySocketService","listenersMap","filter","l","forEach","listener","debugMsg","from","txt"],"mappings":";;;;;;AAAA,OAAOA,EAAP,MAAe,kBAAf;AACA,SAAQC,WAAR,QAA0B,gBAA1B;AAEA,OAAO,IAAMC,sBAAsB,GAAG,YAA/B;AACP,OAAO,IAAMC,yBAAyB,GAAG,cAAlC;AACP,OAAO,IAAMC,yBAAyB,GAAG,cAAlC;AACP,OAAO,IAAMC,6BAA6B,GAAG,kBAAtC;AAGP,IAAMC,OAAO,GAAIC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAA1B,GAAyC,EAAzC,GAA8C,kBAA9D;AACA,OAAO,IAAMC,aAAa,GAAGC,mBAAmB,EAAzC,C,CACP;;AAEAC,MAAM,CAACF,aAAP,GAAuBA,aAAvB,C,CAEA;;AACAA,aAAa,CAACG,KAAd;;AAGA,SAASF,mBAAT,GAA+B;AAC7B,MAAIG,MAAM,GAAG,IAAb;AACA,MAAMJ,aAAa,GAAG;AACdG,IAAAA,KADc,mBACN;AAAA;AAAA;AAAA;AAAA;AAAA;AACZ;AACA;AACA;AACAC,gBAAAA,MAAM,GAAGd,EAAE,CAACM,OAAD,CAAX,CAJY,CAKZ;;AALY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMb,KAPmB;AAQpBS,IAAAA,EARoB,cAQjBC,SARiB,EAQNC,EARM,EAQF;AAChBH,MAAAA,MAAM,CAACC,EAAP,CAAUC,SAAV,EAAqBC,EAArB;AACD,KAVmB;AAWpBC,IAAAA,GAXoB,eAWhBF,SAXgB,EAWI;AAAA,UAATC,EAAS,uEAAN,IAAM;AACtB,UAAI,CAACH,MAAL,EAAa;AACb,UAAI,CAACG,EAAL,EAASH,MAAM,CAACK,kBAAP,CAA0BH,SAA1B,EAAT,KACKF,MAAM,CAACI,GAAP,CAAWF,SAAX,EAAsBC,EAAtB;AACN,KAfmB;AAgBpBG,IAAAA,IAhBoB,gBAgBfJ,SAhBe,EAgBJK,IAhBI,EAgBE;AACpBP,MAAAA,MAAM,CAACM,IAAP,CAAYJ,SAAZ,EAAuBK,IAAvB;AACD,KAlBmB;AAmBpBC,IAAAA,SAnBoB,uBAmBR;AACVR,MAAAA,MAAM,GAAG,IAAT;AACA,KArBkB;AAsBnBS,IAAAA,SAtBmB,qBAsBTP,SAtBS,EAsBEK,IAtBF,EAsBQ;AACxBP,MAAAA,MAAM,CAACS,SAAP,CAAiBH,IAAjB,CAAsBJ,SAAtB,EAAiCK,IAAjC;AACH;AAxBmB,GAAtB;AA0BA,SAAOX,aAAP;AACD,C,CAED;;;AACA,SAASc,wBAAT,GAAoC;AAClC,MAAIC,YAAY,GAAG,EAAnB;AACA,MAAMf,aAAa,GAAG;AACpBe,IAAAA,YAAY,EAAZA,YADoB;AAEpBZ,IAAAA,KAFoB,mBAEZ;AACNY,MAAAA,YAAY,GAAG,EAAf;AACD,KAJmB;AAKpBH,IAAAA,SALoB,uBAKR;AACV,WAAKT,KAAL;AACD,KAPmB;AAQpBE,IAAAA,EARoB,cAQjBC,SARiB,EAQNC,EARM,EAQF;AAChBQ,MAAAA,YAAY,CAACT,SAAD,CAAZ,gCAA+BS,YAAY,CAACT,SAAD,CAAb,IAA6B,EAA3D,IAA+DC,EAA/D;AACD,KAVmB;AAWpBC,IAAAA,GAXoB,eAWhBF,SAXgB,EAWLC,EAXK,EAWD;AACjB,UAAI,CAACQ,YAAY,CAACT,SAAD,CAAjB,EAA8B;AAC9B,UAAI,CAACC,EAAL,EAAS,OAAOQ,YAAY,CAACT,SAAD,CAAnB,CAAT,KACKS,YAAY,CAACT,SAAD,CAAZ,GAA0BS,YAAY,CAACT,SAAD,CAAZ,CAAwBU,MAAxB,CAA+B,UAAAC,CAAC;AAAA,eAAIA,CAAC,KAAKV,EAAV;AAAA,OAAhC,CAA1B;AACN,KAfmB;AAgBpBG,IAAAA,IAhBoB,gBAgBfJ,SAhBe,EAgBJK,IAhBI,EAgBE;AACpB,UAAI,CAACI,YAAY,CAACT,SAAD,CAAjB,EAA8B;AAC9BS,MAAAA,YAAY,CAACT,SAAD,CAAZ,CAAwBY,OAAxB,CAAgC,UAAAC,QAAQ,EAAI;AAC1CA,QAAAA,QAAQ,CAACR,IAAD,CAAR;AACD,OAFD;AAGD,KArBmB;AAsBpBS,IAAAA,QAtBoB,sBAsBT;AACT,WAAKV,IAAL,CAAU,aAAV,EAAyB;AAACW,QAAAA,IAAI,EAAE,SAAP;AAAkBC,QAAAA,GAAG,EAAE;AAAvB,OAAzB;AACD;AAxBmB,GAAtB;AA0BA,SAAOtB,aAAP;AACD,C,CAGD;AACA;AACA;AACA;AACA","sourcesContent":["import io from 'socket.io-client'\r\nimport {httpService} from './http.service'\r\n\r\nexport const SOCKET_EMIT_USER_WATCH = 'user-watch';\r\nexport const SOCKET_EVENT_USER_UPDATED = 'user-updated';\r\nexport const SOCKET_EVENT_REVIEW_ADDED = 'review-added';\r\nexport const SOCKET_EVENT_REVIEW_ABOUT_YOU = 'review-about-you';\r\n\r\n\r\nconst baseUrl = (process.env.NODE_ENV === 'production')? '' : '//localhost:3030'\r\nexport const socketService = createSocketService()\r\n// export const socketService = createDummySocketService()\r\n\r\nwindow.socketService = socketService\r\n\r\n// var socketIsReady = false;\r\nsocketService.setup()\r\n\r\n\r\nfunction createSocketService() {\r\n  var socket = null;\r\n  const socketService = {\r\n    async setup() {\r\n      // YaronB: Need to send a dummy ajax request as to setup the socket-session correctly\r\n      // await httpService.get('setup-session')\r\n      // socket = io(baseUrl, { reconnection: false})\r\n      socket = io(baseUrl)\r\n      // socketIsReady = true;\r\n    },\r\n    on(eventName, cb) {\r\n      socket.on(eventName, cb)\r\n    },\r\n    off(eventName, cb=null) {\r\n      if (!socket) return;\r\n      if (!cb) socket.removeAllListeners(eventName)\r\n      else socket.off(eventName, cb)\r\n    },\r\n    emit(eventName, data) {\r\n      socket.emit(eventName, data)\r\n    },\r\n    terminate() {\r\n      socket = null\r\n     },\r\n     broadcast(eventName, data) {\r\n        socket.broadcast.emit(eventName, data)\r\n    },\r\n  }\r\n  return socketService\r\n}\r\n\r\n// eslint-disable-next-line\r\nfunction createDummySocketService() {\r\n  var listenersMap = {}\r\n  const socketService = {\r\n    listenersMap,\r\n    setup() {\r\n      listenersMap = {}\r\n    },\r\n    terminate() {\r\n      this.setup()\r\n    },\r\n    on(eventName, cb) {\r\n      listenersMap[eventName] = [...(listenersMap[eventName]) || [], cb]\r\n    },\r\n    off(eventName, cb) {\r\n      if (!listenersMap[eventName]) return\r\n      if (!cb) delete listenersMap[eventName]\r\n      else listenersMap[eventName] = listenersMap[eventName].filter(l => l !== cb)\r\n    },\r\n    emit(eventName, data) {\r\n      if (!listenersMap[eventName]) return\r\n      listenersMap[eventName].forEach(listener => {\r\n        listener(data)\r\n      })\r\n    },\r\n    debugMsg() {\r\n      this.emit('chat addMsg', {from: 'Someone', txt: 'Aha it worked!'})\r\n    },\r\n  }\r\n  return socketService\r\n}\r\n\r\n\r\n// Basic Tests\r\n// function cb(x) {console.log(x)}\r\n// socketService.on('baba', cb)\r\n// socketService.emit('baba', 'DATA')\r\n// socketService.off('baba', cb)\r\n\r\n"]}]}